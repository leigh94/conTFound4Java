# 备忘录模式

备忘录模式（Memento Pattern）用于保存对象的状态，以便在需要时恢复。它通常包括三个角色：

Originator（原发器）：创建一个备忘录，记录当前时刻的内部状态，并可以使用备忘录恢复内部状态。

Memento（备忘录)：存储原发器的内部状态。注意：备忘录通常只允许原发器访问其状态，其他类只能看到备忘录的有限接口。

Caretaker（管理者）：负责保存备忘录，但不能对备忘录的内容进行操作或检查。

下面我们通过一个简单的文本编辑器例子来演示备忘录模式。文本编辑器可以保存当前文本的状态，并可以撤销到之前保存的状态。



备忘录模式总结
核心组件：

Memento（备忘录）：存储原发器对象的内部状态

Originator（原发器）：创建一个备忘录，记录当前时刻的内部状态；使用备忘录恢复内部状态

Caretaker（管理者）：负责保存备忘录；不能对备忘录的内容进行操作或检查

优点：

提供了一种恢复状态的机制，使得用户可以方便地回到某个历史状态

实现了信息的封装，用户不需要关心状态的保存细节

简化了原发器职责，原发器不需要管理和保存其内部状态

缺点：

如果状态数据很大，会占用较多的内存资源

管理者负责维护备忘录的生存期，可能会产生额外的内存开销

适用场景：

需要保存/恢复数据相关状态场景

提供一个可回滚的操作

数据库事务管理

游戏存档系统

文本编辑器的撤销/重做功能

绘图应用的历史记录

实现要点：

备忘录应该只被原发器访问，其他对象不应该访问备忘录

考虑使用深拷贝来保存状态，避免状态被意外修改

合理控制备忘录的数量，避免内存占用过多

在需要时考虑备忘录的持久化存储

模式变体：

简单备忘录：只保存单一状态

复杂备忘录：保存多个相关状态

增量备忘录：只保存状态的变化部分

持久化备忘录：将状态保存到文件或数据库

备忘录模式通过将对象的状态保存到外部，实现了状态的可恢复性，是很多需要撤销/重做功能的系统的基础模式。